<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LUMÃ‰ â€” Admin Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700;800&family=DM+Mono:wght@300;400&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0D0D0F;
    --surface: #16161A;
    --surface2: #1E1E24;
    --border: #2A2A32;
    --text: #F0EEF8;
    --muted: #6B6A78;
    --accent: #7C6BFF;
    --accent2: #FF6B9D;
    --green: #4ADE80;
    --yellow: #FBBF24;
    --red: #F87171;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Syne', sans-serif;
    display: flex; min-height: 100vh;
  }

  /* SIDEBAR */
  .sidebar {
    width: 240px; flex-shrink: 0;
    background: var(--surface);
    border-right: 1px solid var(--border);
    padding: 32px 0;
    display: flex; flex-direction: column;
    position: fixed; top: 0; bottom: 0; left: 0;
  }
  .sidebar-logo {
    padding: 0 24px 32px;
    font-size: 22px; font-weight: 800; letter-spacing: 0.08em;
    border-bottom: 1px solid var(--border);
    margin-bottom: 24px;
  }
  .sidebar-logo span { color: var(--accent); }
  .sidebar-tag { font-size: 10px; color: var(--muted); letter-spacing: 0.15em; text-transform: uppercase; }
  .nav-item {
    display: flex; align-items: center; gap: 12px;
    padding: 13px 24px; cursor: pointer;
    font-size: 14px; font-weight: 500;
    color: var(--muted); transition: all 0.2s;
    text-decoration: none;
    border-left: 3px solid transparent;
  }
  .nav-item:hover { color: var(--text); background: var(--surface2); }
  .nav-item.active { color: var(--accent); border-left-color: var(--accent); background: rgba(124,107,255,0.08); }
  .nav-icon { font-size: 18px; width: 20px; text-align: center; }
  .sidebar-section { 
    font-size: 10px; color: var(--muted); letter-spacing: 0.15em;
    text-transform: uppercase; padding: 20px 24px 8px;
  }
  .sidebar-bottom {
    margin-top: auto; padding: 24px;
    border-top: 1px solid var(--border);
  }
  .store-link {
    display: flex; align-items: center; gap: 10px;
    background: var(--accent); color: white;
    padding: 12px 16px; text-decoration: none;
    font-size: 13px; font-weight: 600;
    transition: opacity 0.2s; border-radius: 4px;
  }
  .store-link:hover { opacity: 0.85; }
  .status-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--green); flex-shrink: 0; }

  /* MAIN */
  .main {
    margin-left: 240px; flex: 1;
    display: flex; flex-direction: column; min-height: 100vh;
  }
  .topbar {
    background: var(--surface);
    border-bottom: 1px solid var(--border);
    padding: 20px 36px;
    display: flex; align-items: center; justify-content: space-between;
    position: sticky; top: 0; z-index: 10;
  }
  .page-title { font-size: 20px; font-weight: 700; }
  .topbar-right { display: flex; align-items: center; gap: 20px; }
  .admin-badge {
    background: rgba(124,107,255,0.15); color: var(--accent);
    padding: 6px 14px; font-size: 12px; border-radius: 20px;
    font-weight: 600;
  }
  .live-dot { display: flex; align-items: center; gap: 8px; font-size: 13px; color: var(--green); }
  .content { padding: 36px; flex: 1; }

  /* PANELS */
  .panel { display: none; }
  .panel.active { display: block; }

  /* STATS */
  .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 32px; }
  .stat-card {
    background: var(--surface); border: 1px solid var(--border);
    padding: 24px; position: relative; overflow: hidden;
  }
  .stat-card::before {
    content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px;
    background: var(--accent-color, var(--accent));
  }
  .stat-label { font-size: 11px; color: var(--muted); text-transform: uppercase; letter-spacing: 0.12em; margin-bottom: 12px; }
  .stat-value { font-size: 36px; font-weight: 800; line-height: 1; margin-bottom: 8px; }
  .stat-change { font-size: 12px; }
  .up { color: var(--green); }
  .down { color: var(--red); }

  /* CHARTS AREA */
  .charts-row { display: grid; grid-template-columns: 2fr 1fr; gap: 20px; margin-bottom: 32px; }
  .card {
    background: var(--surface); border: 1px solid var(--border); padding: 24px;
  }
  .card-title { font-size: 13px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.1em; color: var(--muted); margin-bottom: 20px; }

  /* SIMPLE BAR CHART */
  .bar-chart { display: flex; align-items: flex-end; gap: 8px; height: 120px; padding-top: 16px; }
  .bar-wrap { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 6px; height: 100%; justify-content: flex-end; }
  .bar { width: 100%; background: var(--accent); opacity: 0.7; transition: opacity 0.2s; border-radius: 2px 2px 0 0; position: relative; }
  .bar:hover { opacity: 1; }
  .bar-label { font-size: 10px; color: var(--muted); font-family: 'DM Mono', monospace; }

  /* VISITORS */
  .visitor-list { display: flex; flex-direction: column; gap: 10px; max-height: 200px; overflow-y: auto; }
  .visitor-item {
    display: flex; align-items: center; gap: 12px;
    padding: 12px; background: var(--surface2);
    font-size: 12px; font-family: 'DM Mono', monospace;
  }
  .visitor-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--green); flex-shrink: 0; animation: pulse 2s infinite; }
  @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.4} }
  .visitor-time { color: var(--muted); margin-left: auto; }
  .no-data { color: var(--muted); font-size: 13px; text-align: center; padding: 20px; }

  /* PRODUCTS TABLE */
  .table-actions {
    display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;
  }
  .btn {
    background: var(--accent); color: white; border: none;
    padding: 12px 24px; font-size: 13px; font-weight: 600;
    font-family: 'Syne', sans-serif; cursor: pointer;
    transition: opacity 0.2s;
  }
  .btn:hover { opacity: 0.85; }
  .btn-sm {
    padding: 6px 14px; font-size: 12px;
  }
  .btn-danger { background: var(--red); }
  .btn-outline {
    background: transparent; border: 1px solid var(--border); color: var(--text);
  }
  table { width: 100%; border-collapse: collapse; }
  thead tr { border-bottom: 1px solid var(--border); }
  th {
    text-align: left; padding: 12px 16px;
    font-size: 11px; text-transform: uppercase; letter-spacing: 0.12em;
    color: var(--muted); font-weight: 600;
  }
  td { padding: 16px; border-bottom: 1px solid rgba(42,42,50,0.5); font-size: 14px; }
  tr:hover td { background: var(--surface2); }
  .product-emoji { font-size: 28px; margin-right: 12px; }
  .product-row-name { font-weight: 600; }
  .product-row-desc { color: var(--muted); font-size: 12px; margin-top: 2px; }
  .badge {
    display: inline-block; padding: 3px 10px; font-size: 11px;
    background: rgba(124,107,255,0.2); color: var(--accent);
    font-weight: 600;
  }
  .badge-new { background: rgba(74,222,128,0.15); color: var(--green); }
  .badge-sale { background: rgba(251,191,36,0.15); color: var(--yellow); }

  /* MODAL */
  .modal-overlay {
    position: fixed; inset: 0; background: rgba(0,0,0,0.7);
    z-index: 300; display: none; align-items: center; justify-content: center;
  }
  .modal-overlay.open { display: flex; }
  .modal {
    background: var(--surface); border: 1px solid var(--border);
    padding: 36px; width: 520px; max-width: 90vw;
  }
  .modal h2 { font-size: 20px; font-weight: 700; margin-bottom: 28px; }
  .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
  .form-group { margin-bottom: 18px; }
  .form-group label { display: block; font-size: 12px; color: var(--muted); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.1em; }
  .form-group input, .form-group select, .form-group textarea {
    width: 100%; background: var(--surface2); border: 1px solid var(--border);
    color: var(--text); padding: 12px 14px; font-family: 'Syne', sans-serif;
    font-size: 14px; outline: none; transition: border-color 0.2s;
  }
  .form-group input:focus, .form-group select:focus { border-color: var(--accent); }
  .form-group select option { background: var(--surface2); }
  .modal-actions { display: flex; gap: 12px; margin-top: 28px; justify-content: flex-end; }

  /* VISITORS PAGE */
  .visitors-stats { display: grid; grid-template-columns: repeat(3,1fr); gap: 20px; margin-bottom: 32px; }
  .visitor-table-item {
    display: flex; align-items: center; gap: 16px; padding: 16px;
    border-bottom: 1px solid rgba(42,42,50,0.5);
    font-size: 13px;
  }
  .visitor-table-item:hover { background: var(--surface2); }
  .visit-page { font-family: 'DM Mono', monospace; color: var(--accent); }
  .visit-time { color: var(--muted); margin-left: auto; font-family: 'DM Mono', monospace; font-size: 11px; }

  /* SCROLLBAR */
  ::-webkit-scrollbar { width: 4px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: var(--border); }
</style>
</head>
<body>

<!-- SIDEBAR -->
<aside class="sidebar">
  <div class="sidebar-logo">LUMÃ‰<span>.</span><br><div class="sidebar-tag">Admin Panel</div></div>
  
  <div class="nav-item active" onclick="showPanel('dashboard', this)">
    <span class="nav-icon">âŠž</span> Dashboard
  </div>
  <div class="nav-item" onclick="showPanel('products', this)">
    <span class="nav-icon">â—ˆ</span> Products
  </div>
  <div class="nav-item" onclick="showPanel('visitors', this)">
    <span class="nav-icon">â—‰</span> Visitors
  </div>
  
  <div class="sidebar-section">Settings</div>
  <div class="nav-item" onclick="showPanel('settings', this)">
    <span class="nav-icon">âš™</span> Store Settings
  </div>

  <div class="sidebar-bottom">
    <a href="store.html" class="store-link" target="_blank">
      <div class="status-dot"></div>
      View Store Live â†—
    </a>
  </div>
</aside>

<!-- MAIN -->
<main class="main">
  <div class="topbar">
    <div class="page-title" id="pageTitle">Dashboard</div>
    <div class="topbar-right">
      <div class="live-dot"><div class="status-dot"></div>Store Online</div>
      <div class="admin-badge">Admin</div>
    </div>
  </div>

  <div class="content">

    <!-- DASHBOARD PANEL -->
    <div class="panel active" id="panel-dashboard">
      <div class="stats-grid">
        <div class="stat-card" style="--accent-color: var(--accent)">
          <div class="stat-label">Total Products</div>
          <div class="stat-value" id="stat-products">4</div>
          <div class="stat-change up">â†‘ In store</div>
        </div>
        <div class="stat-card" style="--accent-color: var(--green)">
          <div class="stat-label">Visitors Today</div>
          <div class="stat-value" id="stat-visitors">0</div>
          <div class="stat-change up">â†‘ Live data</div>
        </div>
        <div class="stat-card" style="--accent-color: var(--yellow)">
          <div class="stat-label">Cart Items</div>
          <div class="stat-value" id="stat-cart">0</div>
          <div class="stat-change">In active carts</div>
        </div>
        <div class="stat-card" style="--accent-color: var(--accent2)">
          <div class="stat-label">Cart Value</div>
          <div class="stat-value" id="stat-value">$0</div>
          <div class="stat-change">Pending checkout</div>
        </div>
      </div>

      <div class="charts-row">
        <div class="card">
          <div class="card-title">Visits This Week (Simulated)</div>
          <div class="bar-chart" id="barChart"></div>
        </div>
        <div class="card">
          <div class="card-title">Recent Visitors</div>
          <div class="visitor-list" id="recentVisitors">
            <div class="no-data">No visits recorded yet.<br>Visit the store to see data.</div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Recent Products</div>
        <div id="dashProductList"></div>
      </div>
    </div>

    <!-- PRODUCTS PANEL -->
    <div class="panel" id="panel-products">
      <div class="table-actions">
        <div style="font-size:14px;color:var(--muted)" id="productCount">Manage your store products</div>
        <button class="btn" onclick="openModal()">+ Add Product</button>
      </div>
      <div class="card" style="padding:0">
        <table>
          <thead>
            <tr>
              <th style="padding-left:24px">Product</th>
              <th>Price</th>
              <th>Badge</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="productsTable"></tbody>
        </table>
      </div>
    </div>

    <!-- VISITORS PANEL -->
    <div class="panel" id="panel-visitors">
      <div class="visitors-stats">
        <div class="stat-card" style="--accent-color:var(--green)">
          <div class="stat-label">Total Visits</div>
          <div class="stat-value" id="totalVisits">0</div>
        </div>
        <div class="stat-card" style="--accent-color:var(--accent)">
          <div class="stat-label">Store Page</div>
          <div class="stat-value" id="storeVisits">0</div>
        </div>
        <div class="stat-card" style="--accent-color:var(--yellow)">
          <div class="stat-label">Cart Opens</div>
          <div class="stat-value" id="cartOpens">â€”</div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Visit Log</div>
        <div id="visitLog">
          <div class="no-data">No visits yet. <a href="store.html" target="_blank" style="color:var(--accent)">Open the store â†’</a></div>
        </div>
      </div>
    </div>

    <!-- SETTINGS PANEL -->
    <div class="panel" id="panel-settings">
      <div class="card">
        <div class="card-title">Store Settings</div>
        <div style="max-width:480px">
          <div class="form-group">
            <label>Store Name</label>
            <input type="text" value="LUMÃ‰" id="storeName">
          </div>
          <div class="form-group">
            <label>Store Tagline</label>
            <input type="text" value="Crafted for those who notice things" id="storeTagline">
          </div>
          <div class="form-group">
            <label>Free Shipping Threshold ($)</label>
            <input type="number" value="75" id="shippingThreshold">
          </div>
          <div class="form-group">
            <label>Store Status</label>
            <select id="storeStatus">
              <option value="online">Online</option>
              <option value="maintenance">Maintenance</option>
            </select>
          </div>
          <button class="btn" onclick="saveSettings()">Save Settings</button>
        </div>
      </div>
    </div>

  </div><!-- /content -->
</main>

<!-- ADD PRODUCT MODAL -->
<div class="modal-overlay" id="modalOverlay">
  <div class="modal">
    <h2 id="modalTitle">Add New Product</h2>
    <div class="form-row">
      <div class="form-group">
        <label>Product Name</label>
        <input type="text" id="pName" placeholder="Arcadia Vessel">
      </div>
      <div class="form-group">
        <label>Emoji Icon</label>
        <input type="text" id="pEmoji" placeholder="ðŸº">
      </div>
    </div>
    <div class="form-group">
      <label>Description</label>
      <input type="text" id="pDesc" placeholder="Hand-thrown ceramic">
    </div>
    <div class="form-row">
      <div class="form-group">
        <label>Price ($)</label>
        <input type="number" id="pPrice" placeholder="128">
      </div>
      <div class="form-group">
        <label>Original Price (optional)</label>
        <input type="number" id="pOriginal" placeholder="â€”">
      </div>
    </div>
    <div class="form-row">
      <div class="form-group">
        <label>Badge</label>
        <select id="pBadge">
          <option value="">None</option>
          <option value="New">New</option>
          <option value="Sale">Sale</option>
          <option value="Hot">Hot</option>
          <option value="Limited">Limited</option>
        </select>
      </div>
      <div class="form-group">
        <label>Color Theme</label>
        <select id="pImg">
          <option value="product-img-1">Warm Tan</option>
          <option value="product-img-2">Sage Green</option>
          <option value="product-img-3">Lavender</option>
          <option value="product-img-4">Wheat</option>
        </select>
      </div>
    </div>
    <div class="modal-actions">
      <button class="btn btn-outline" onclick="closeModal()">Cancel</button>
      <button class="btn" onclick="saveProduct()">Save Product</button>
    </div>
  </div>
</div>

<script>
let products = JSON.parse(localStorage.getItem('lume_products') || 'null') || [
  { id: 1, name: 'Arcadia Vessel', desc: 'Hand-thrown ceramic', price: 128, original: null, badge: 'New', emoji: 'ðŸº', imgClass: 'product-img-1' },
  { id: 2, name: 'Botanic Print', desc: 'Fine art archival print', price: 89, original: 120, badge: 'Sale', emoji: 'ðŸŒ¿', imgClass: 'product-img-2' },
  { id: 3, name: 'Linen Throw', desc: 'Belgian washed linen', price: 175, original: null, badge: null, emoji: 'ðŸ§µ', imgClass: 'product-img-3' },
  { id: 4, name: 'Stone Candleholder', desc: 'Carved travertine', price: 64, original: null, badge: 'New', emoji: 'ðŸ•¯', imgClass: 'product-img-4' },
];
let editingId = null;

function saveProducts() {
  localStorage.setItem('lume_products', JSON.stringify(products));
}

function showPanel(name, el) {
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  document.getElementById('panel-' + name).classList.add('active');
  el.classList.add('active');
  const titles = { dashboard: 'Dashboard', products: 'Products', visitors: 'Visitors', settings: 'Store Settings' };
  document.getElementById('pageTitle').textContent = titles[name];
  if (name === 'dashboard') refreshDashboard();
  if (name === 'products') renderProductsTable();
  if (name === 'visitors') renderVisitors();
}

function refreshDashboard() {
  document.getElementById('stat-products').textContent = products.length;
  const visits = JSON.parse(localStorage.getItem('lume_visits') || '[]');
  document.getElementById('stat-visitors').textContent = visits.length;

  const cart = JSON.parse(localStorage.getItem('lume_cart') || '[]');
  const cartCount = cart.reduce((s, i) => s + i.qty, 0);
  const cartVal = cart.reduce((s, i) => s + i.price * i.qty, 0);
  document.getElementById('stat-cart').textContent = cartCount;
  document.getElementById('stat-value').textContent = '$' + cartVal.toFixed(0);

  // Bar chart
  const days = ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];
  const vals = days.map(() => Math.floor(Math.random() * 80 + 10));
  const max = Math.max(...vals);
  document.getElementById('barChart').innerHTML = days.map((d, i) => `
    <div class="bar-wrap">
      <div class="bar" style="height:${Math.round(vals[i]/max*100)}%;background:${i===4?'var(--accent2)':'var(--accent)'}"></div>
      <div class="bar-label">${d}</div>
    </div>
  `).join('');

  // Recent visitors
  const rv = document.getElementById('recentVisitors');
  if (visits.length === 0) {
    rv.innerHTML = '<div class="no-data">No visits yet. <a href="store.html" target="_blank" style="color:var(--accent)">Open the store â†’</a></div>';
  } else {
    rv.innerHTML = visits.slice(-6).reverse().map(v => `
      <div class="visitor-item">
        <div class="visitor-dot"></div>
        <span>Store Page</span>
        <span class="visitor-time">${new Date(v.time).toLocaleTimeString()}</span>
      </div>
    `).join('');
  }

  // Dash product list
  document.getElementById('dashProductList').innerHTML = `
    <table style="width:100%"><tbody>
    ${products.slice(0,3).map(p => `
      <tr>
        <td style="padding:14px 24px"><span>${p.emoji} </span><strong>${p.name}</strong></td>
        <td style="color:var(--muted);font-size:13px">${p.desc}</td>
        <td style="color:var(--accent);font-weight:700">$${p.price}</td>
      </tr>
    `).join('')}
    </tbody></table>
  `;
}

function renderProductsTable() {
  document.getElementById('productCount').textContent = `${products.length} product${products.length !== 1 ? 's' : ''} in your store`;
  const tbody = document.getElementById('productsTable');
  tbody.innerHTML = products.map(p => `
    <tr>
      <td style="padding-left:24px">
        <div style="display:flex;align-items:center">
          <span class="product-emoji">${p.emoji}</span>
          <div>
            <div class="product-row-name">${p.name}</div>
            <div class="product-row-desc">${p.desc}</div>
          </div>
        </div>
      </td>
      <td>
        <strong>$${p.price}</strong>
        ${p.original ? `<span style="color:var(--muted);font-size:12px;text-decoration:line-through;margin-left:8px">$${p.original}</span>` : ''}
      </td>
      <td>${p.badge ? `<span class="badge badge-${p.badge.toLowerCase()}">${p.badge}</span>` : 'â€”'}</td>
      <td>
        <button class="btn btn-sm btn-outline" onclick="editProduct(${p.id})" style="margin-right:8px">Edit</button>
        <button class="btn btn-sm btn-danger" onclick="deleteProduct(${p.id})">Delete</button>
      </td>
    </tr>
  `).join('');
}

function renderVisitors() {
  const visits = JSON.parse(localStorage.getItem('lume_visits') || '[]');
  document.getElementById('totalVisits').textContent = visits.length;
  document.getElementById('storeVisits').textContent = visits.filter(v => v.page === 'store').length;
  
  const log = document.getElementById('visitLog');
  if (visits.length === 0) {
    log.innerHTML = '<div class="no-data">No visits yet. <a href="store.html" target="_blank" style="color:var(--accent)">Open the store â†’</a></div>';
    return;
  }
  log.innerHTML = visits.slice().reverse().map((v, i) => `
    <div class="visitor-table-item">
      <div class="visitor-dot" style="${i > 2 ? 'background:var(--muted);animation:none' : ''}"></div>
      <span>#${visits.length - i}</span>
      <span class="visit-page">/${v.page}</span>
      <span class="visit-time">${new Date(v.time).toLocaleString()}</span>
    </div>
  `).join('');
}

function openModal(id) {
  editingId = null;
  document.getElementById('modalTitle').textContent = 'Add New Product';
  document.getElementById('pName').value = '';
  document.getElementById('pEmoji').value = '';
  document.getElementById('pDesc').value = '';
  document.getElementById('pPrice').value = '';
  document.getElementById('pOriginal').value = '';
  document.getElementById('pBadge').value = '';
  document.getElementById('pImg').value = 'product-img-1';
  document.getElementById('modalOverlay').classList.add('open');
}

function editProduct(id) {
  const p = products.find(x => x.id === id);
  editingId = id;
  document.getElementById('modalTitle').textContent = 'Edit Product';
  document.getElementById('pName').value = p.name;
  document.getElementById('pEmoji').value = p.emoji;
  document.getElementById('pDesc').value = p.desc;
  document.getElementById('pPrice').value = p.price;
  document.getElementById('pOriginal').value = p.original || '';
  document.getElementById('pBadge').value = p.badge || '';
  document.getElementById('pImg').value = p.imgClass || 'product-img-1';
  document.getElementById('modalOverlay').classList.add('open');
}

function closeModal() {
  document.getElementById('modalOverlay').classList.remove('open');
}

function saveProduct() {
  const name = document.getElementById('pName').value.trim();
  if (!name) { alert('Please enter a product name'); return; }
  const data = {
    name,
    emoji: document.getElementById('pEmoji').value || 'âœ¦',
    desc: document.getElementById('pDesc').value || '',
    price: parseFloat(document.getElementById('pPrice').value) || 0,
    original: parseFloat(document.getElementById('pOriginal').value) || null,
    badge: document.getElementById('pBadge').value || null,
    imgClass: document.getElementById('pImg').value,
  };
  if (editingId) {
    const idx = products.findIndex(x => x.id === editingId);
    products[idx] = { ...products[idx], ...data };
  } else {
    data.id = Date.now();
    products.push(data);
  }
  saveProducts();
  closeModal();
  renderProductsTable();
}

function deleteProduct(id) {
  if (!confirm('Delete this product?')) return;
  products = products.filter(x => x.id !== id);
  saveProducts();
  renderProductsTable();
  document.getElementById('stat-products').textContent = products.length;
}

function saveSettings() {
  alert('Settings saved! (In a real app, these would update your store.)');
}

// Close modal on outside click
document.getElementById('modalOverlay').addEventListener('click', function(e) {
  if (e.target === this) closeModal();
});

// Init
refreshDashboard();

// Track admin visit
const visits = JSON.parse(localStorage.getItem('lume_visits') || '[]');
visits.push({ time: new Date().toISOString(), page: 'admin' });
localStorage.setItem('lume_visits', JSON.stringify(visits));

// Auto-refresh stats every 5s
setInterval(() => {
  if (document.getElementById('panel-dashboard').classList.contains('active')) {
    const v = JSON.parse(localStorage.getItem('lume_visits') || '[]');
    document.getElementById('stat-visitors').textContent = v.length;
    const c = JSON.parse(localStorage.getItem('lume_cart') || '[]');
    document.getElementById('stat-cart').textContent = c.reduce((s,i)=>s+i.qty,0);
    document.getElementById('stat-value').textContent = '$' + c.reduce((s,i)=>s+i.price*i.qty,0).toFixed(0);
  }
}, 5000);
</script>
</body>
</html>
